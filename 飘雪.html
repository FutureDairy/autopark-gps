<!DOCTYPE html>  
<html lang="en">  
<head>  
    <meta charset="UTF-8">  
    <title>飘雪特效（可以上传你的图片哦~ 董士林gay佬除外）</title>
    <link rel="shortcut icon" href="http://static.hdslb.com/images/favicon.ico">
    <style type="text/css"> 
        canvas {
            border:2px dotted red;  
            /*添加背景图片 */
            background: url(http://r.photo.store.qq.com/psb?/V13V8s2d4CiB1p/OISpFZvYgu2lpsVna0MaeB7kpGKirhUVo44Cmu3KF2Y!/r/dLwAAAAAAAAA) center no-repeat ;  
            background-size: cover;
        }

        img{
    max-width: 2128px;
    max-height: 2128px;
    height:auto;
    zoom:expression( function(e) {
if(e.width>e.height) {if (e.width>128) { e.height = e.height*(128 /e.width); e.width=128; }}
else {if (e.height>128) { e.width = e.width*(128 /e.height); e.height=128; }}
e.style.zoom = '1';     }(this));
         overflow:hidden; 
}

input{
	padding: 0 20px;
}
   
    </style> 

    <script type="text/javascript" src="https://ss1.bdstatic.com/5eN1bjq8AAUYm2zgoY3K/r/www/cache/static/protocol/https/jquery/jquery-1.10.2.min_65682a2.js"> </script>

</head>  
<body align='center'  >  
	<h1 style="font-size: 28pt">飘雪特效（可以上传你的图片哦~ 等虱淋gay佬除外）</h1>
    <canvas id="canvas" width="900" height="1100"></canvas>
<br/> 

<div align="center" style="display: flex; margin: 15px ">
    <button style="  margin-right: 10px;  margin-left: auto; height: 70px; width: 230px;font-size: 26pt" onclick="prev()">上一张</button>
    
<div align="center" style="margin-top:1px">
    <label style="font-size: 30pt; color: red">↓↓↓点击替换图片</label> 
    <br>
 <input type="file" style=" padding:0px 20px; " onchange="selectImage(this);"/>  
 </div>
    <button style=" margin-right: auto;  margin-left: 10px;height: 70px; width: 230px;font-size: 26pt" onclick="next()">下一张</button>
</div> 

    <label style="font-size: 23pt">宽度：</label>
    <input id='inputW' style="height: 50px;font-size: 23pt; text-align: center; margin-right: 20px" value="900" placeholder="输入宽度" > 

    <label style="font-size: 23pt">高度：</label>
    <input id='inputH' style="height: 50px; font-size: 23pt; text-align: center; " value="1100" placeholder="输入高度"  > 
<br>
<br>
    <button style="height: 70px; width: 100%; margin: auto; font-size: 26pt" onclick="setWidth();setHeight()">确 定</button>

<span id="width_caculator" hidden></span> 
<script> 
 	
/*获取到Url里面的参数*/
//原文：https://blog.csdn.net/qq_41485414/article/details/79577879  
(function ($) {
  $.getUrlParam = function (name) {
   var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
   var r = window.location.search.substr(1).match(reg);
   if (r != null) return unescape(r[2]); return null;
  }
 })(jQuery);
  
 
// 原文：https://blog.csdn.net/lianzhang861/article/details/84306139  
    function input_resize(obj){
    $("#width_caculator").html(obj.value)
    $("#width_caculator").css("fontSize", $(obj).css('fontSize'))
    var width= $("#width_caculator").css('width').replace('px', '');
    var newW = parseInt(width)+195;
    $(obj).css('width', newW) 
    } 
$("#inputW").each(function(event){input_resize(this)});
$("#inputW").bind("input propertychange change",function(event){input_resize(this)});
$("#inputH").each(function(event){input_resize(this)});
$("#inputH").bind("input propertychange change",function(event){input_resize(this)});
</script> 

<br/>

<script> 
	var picInd = 0;
	var pics = [];
	pics.push('https://t1.picb.cc/uploads/2019/01/10/VtfDLR.jpg');
	pics.push('https://ss0.bdstatic.com/94oJfD_bAAcT8t7mm9GUKT-xh_/timg?image&quality=100&size=b4000_4000&sec=1547124189&di=b161f0cacb7bb3bc0e720842933c54cc&src=http://i2.hdslb.com/bfs/archive/7bce692b2be6fe3801c78c4603b0807f020f53c1.jpg');
	pics.push('http://r.photo.store.qq.com/psb?/V13V8s2d4CiB1p/uYIdLd2HmJxK4Nl74onng20Q59fn8ATgpDCKkkpEPLQ!/r/dFIBAAAAAAAA');
	pics.push('http://r.photo.store.qq.com/psb?/V13V8s2d4CiB1p/ec5ad53asULaVKcpR4vwy9I1em0kgcZRt7ksbZLnb3A!/r/dL4AAAAAAAAA');
	pics.push('https://t1.picb.cc/uploads/2019/01/10/VtfKf8.jpg');

	pics.push('http://r.photo.store.qq.com/psb?/V12gWK6Y30CrcG/M5Fx60BDFSgUuMJ*Um9JsveGJGwW7r*cHhfd460pYdw!/r/dPIAAAAAAAAA');
	pics.push('http://r.photo.store.qq.com/psb?/V12gWK6Y1faAfm/lBpiGsLT7pngarK1L*1JS2uUAuWZ1pifN71ea6zdSp0!/r/dD8BAAAAAAAA');
	pics.push('http://r.photo.store.qq.com/psb?/V12gWK6Y1faAfm/dpUsfY*mrOycpgozrBBjNU0axnNOsKKdrskaenRhm2M!/r/dGkAAAAAAAAA');

	if($.getUrlParam('dws')){
		pics = []
		pics.push('https://t1.picb.cc/uploads/2019/01/10/Vt6ECF.jpg');
		pics.push('https://ss0.bdstatic.com/94oJfD_bAAcT8t7mm9GUKT-xh_/timg?image&quality=100&size=b4000_4000&sec=1547124189&di=b161f0cacb7bb3bc0e720842933c54cc&src=http://i2.hdslb.com/bfs/archive/7bce692b2be6fe3801c78c4603b0807f020f53c1.jpg'); 

		document.getElementById('canvas').style = 'background: url(https://t1.picb.cc/uploads/2019/01/10/Vt6ECF.jpg) center no-repeat; background-size: cover;';
	 }

	function setWidth(){
		try{
		$('#canvas').attr('width', $('#inputW').val());
		}catch(e){
			alert('错误：'+e.toString())
		}
	}
	function setHeight(){
		try{
		$('#canvas').attr('height', $('#inputH').val())
		}catch(e){
			alert('错误：'+e.toString())
		}
	}
	function prev(){
		picInd--;
		if(picInd < 0)
			picInd = pics.length-1; 
		document.getElementById('canvas').style = 'background: url('+ pics[picInd] +') center no-repeat; background-size: cover;';
		
	}
	function next(){
		picInd++;
		if(picInd > pics.length-1)
			picInd = 0; 
		document.getElementById('canvas').style = 'background: url('+ pics[picInd] +') center no-repeat; background-size: cover;';
	}

    var image = '';
    function selectImage(file) {
        if (!file.files || !file.files[0]) {
            return;
        }
        var reader = new FileReader();
        reader.onload = function (evt) { 
            document.getElementById('canvas').style = 'background: url('+evt.target.result+') center no-repeat; background-size: cover;';
            //image = evt.target.result;
        }
        reader.readAsDataURL(file.files[0]);
    }
 
</script>

    <script type="text/javascript">  
        var can = document.getElementById("canvas");  
        var ctx = can.getContext("2d");  
        //定义一个随机函数  
        function random(min,max){  
            return parseInt(Math.random()*(max-min)+min);  
        }  
        //创建一个动画类  
        function AnimationClass(){  
            //雪花出现的坐标  
            this.x = random(0,can.width);//横坐标随机  
            this.y = 0;//纵坐标为0  
            this.radius = random(1,5);//雪花的半径随机  
            this.color = "white";//颜色红色  
            this.speed = random(1,6);//雪花降落的速度随机  
            this.startAngle = 0;//起始角度  
            this.endAngle = Math.PI*2;//终止角度  
        }  
        //给雪花动画类添加一个方法  
        AnimationClass.prototype.draw = function(){  
            ctx.save();//储存  
            ctx.fillStyle = this.color;//填充颜色  
            //绘制雪花  
            ctx.beginPath();  
            ctx.arc(this.x,this.y,this.radius,this.startAngle,this.endAngle);//画圆  
            ctx.fill();  
            ctx.restore();  
            this.sport();//调用运动函数使雪花运动起来  
        };  
        //雪花运动原型方法  
        AnimationClass.prototype.sport = function(){  
            this.y += this.speed;//雪花y方向上的值累加  
        };  
        //创建一个雪花对象  
        var dataArr =[];  
        function show(){  
            can.height = can.height;//清除画布内容  
            var A = new AnimationClass();//创建一个雪花动画A  
            dataArr.push(A);//将创建的雪花动画储存在数组dataArr中  
            //调用创建的数组中雪花对象方法  
            for (var i in dataArr){  
                dataArr[i].draw();  
            }  
            requestAnimationFrame(show);//循环调用  
        }  
        show();  
    </script>  
</body>  
</html>
